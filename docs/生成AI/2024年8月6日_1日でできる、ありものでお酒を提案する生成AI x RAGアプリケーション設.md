# 1日でできる、ありものでお酒を提案する生成AI x RAGアプリケーション設計・実装（機能要件）

## 機能概要

- 1日でできる、ありものでお酒を提案する生成AI x RAGアプリケーション設計・実装

## 仕様

### 入力

- お酒の種類(ウィスキー固定)
- その日の天候(快晴で固定)
- 依頼主の体調(選択)
- 家にあるお酒とつまみの情報(データベース)
- 家にないけど手軽に調達できるもの(推論)

### 出力

- 飲み物の名前
- 作り方

### 利用技術

- 言語モデル
  - OpenAI GPT-4o
- フレームワーク
  - Langchain
- プラットフォーム
  - AWS
    - Lambda
    - DynamoDB

### 処理手順

- LLMへの問い合わせ
    - 以下のプロンプトで提案を求めます

```
あなたはスーパーバーテンダーです。
＜入力＞に書かれた[お酒の種類], [依頼主の体調], [その日の天候]の情報をもとに、
手軽に作れる飲み物とおつまみを提案してください。提案には＜出力＞に記載された情報を必ず含めてください。また、在庫がないことも考慮し、いくつかの提案をしてください。

提案内容を入力として、必ず在庫データベース検索ツールを呼び出してください

＜入力＞

[お酒の種類]
ウィスキー

[依頼主の体調]
良好

[季節]
夏(8月)

[その日の天候]
快晴

＜出力＞

[レシピ]
{{recipe_text}}

[お酒のなまえ]
{{alcohol}}

[つまみ]
{{snack}}

[割りもの（水やサイダーなどソフトドリンク）]
{{mixer}}

```

- 在庫データベース検索 `tool`
  - プロンプトの出力に含まれる{{alcohol}}, {{snack}}, {{mixer}}が在庫データに存在するか検索します（RAG）

- レシピ保存
  - 生成AIからの提案内容が、在庫データベース検索結果に含まれる場合、検索結果に存在する場合、レシピに加えます （データ保存）

## 次のアクション

- ２つのプロンプト間の属性の受け渡しの設計
  - プロンプトと在庫データベース検索のツールの連携は、 langchain 0.2以上で create_structured_chat_agent を用いて実装できそう https://github.com/langchain-ai/langchain/blob/master/libs/langchain/langchain/agents/structured_chat/base.py

- アプリケーションの設計

```
    ・実際に書いてみる必要がある。
    ・create_structured_chat_agent実行時に渡すpromptと create_structured_chat_agent実行後に返却されたオブジェクトに対してrunメソッド実行する時に指定するqueryパラメータ どう違うの？
    ・create_structured_chat_agent実行後に返却されたオブジェクトに対してrunメソッド実行するというのは使い方として合ってる？
    ・langchainには他の２種類agentを生成する関数が用意されているのを見かけました。これらはどのように使うべきですか？今回これらを使って実装することは可能？
        create_react_agent
        create_json_agent
```

- アプリケーションの実装
- データベースの設計
- テスト用データベースの構築

## 備考: テスト用データベースの構築に用いる在庫データ

```
山崎ウィスキー（ノンエイジ）
ジャックダニエル ハニー

ウィルキンソン
コカ・コーラ
キリン・レモン

カシューナッツ
アーモンド
```


# 202年1月16日_生成AI活用

## やること

- 実際の案件で行った修正工数の算出のやり取りを生成AIでの置き換え可能か検討する

## プロンプト

```
# 役割

あなたは、Go言語のバックエンド開発のスペシャリストです。

# 指示・質問

条件に記載したバックエンドアプリケーションに関する
修正工数（ユニットテストまで）の算出をお願いします。
  
# 条件 

1.修正内容は、チケットを参照してください。
  件名: 作業受け入れ可能日の入力チェック処理の改修
  URL: https://secret-fqdn/browse/ASAP-5029

2. 修正工数は人日単位で算出してください。この時、内訳としてプログラム修正, ユニットテスト修正それぞれの工数（人日）と理由、参考情報として、現状のプログラム実装箇所を添えてください。
  
3. 算出した修正工数は、上記チケットのコメントに記録として残してください。出力形式は、回答サンプル の記載内容を参考にしてください。

4. バックエンドアプリケーションのリポジトリは以下のURLからアクセスできます。
  https://secret-aws-fqdn/codesuite/codecommit/repositories/backend/browse/refs/heads/develop

5. 最新の機能設計書には以下のURLからアクセスできます
  https://secret-box-fqdn/file/1366044112450

# 回答サンプル

1. 修正工数: 0人日

内訳: プログラム修正 0人日、ユニットテスト修正 0人日

2. 理由: 

バックエンド側の作業料の請求受入可能日の入力チェック処理実装を確認しました。
対応内容に記載されている以下の２つの入力チェックは、バックエンド側ではそもそも行なっていないようです。
 • 作業受け入れ可能日が工事着手予定日より後である
 • タスク登録日以降等の他のバリデーションチェック
そのため、チケットに記載された対応内容通りであれば、BE作業は不要（0人日）という認識です。

3. 備考:

バックエンド側の作業の請求受入可能日(acceptable_for_request_date )の入力チェック処理実装箇所はこちらです
• https://secret-aws-fqdn/codesuite/codecommit/repositories/backend/browse/refs/heads/develop/--/domain/business/designprj/contract.go?region=ap-northeast-1&lines=152-152
• https://secret-aws-fqdn/codesuite/codecommit/repositories/backend/browse/refs/heads/develop/--/domain/business/designprj/contract.go?region=ap-northeast-1&lines=201-201
```

## 考察

- 課題: 修正工数の算出は、過去の経験に基づく部分が大きい。
  - 考察: AIで置き換えるには過去の実績データを与える必要がある

- 課題: 生成AIから条件に記述したチケット、ソースコード、機能設計書に対するアクセス許可がおりていない。
  - 考察: AIで置き換えるには生成AIからこれらの情報を参照できるようにする必要がある
    - 直接アクセスできるようにすることは可能か
    - 生成AIのプロンプトに含めることは現実的に可能か
    - 生成AIにPDFやExcelファイルを添付した場合、直接アクセスするのと同じ結果が得られるか

- 課題: 修正工数算出時に与えられる情報は、日本語での自由記述に近い。ソースコードや機能仕様書との関連付けが課題となる
  - 考察: 修正工数の算出を生成AIで置き換える前提で、ソースコードや機能仕様書と、修正工数算出時に与えられる情報の関連づけを考える場合、いくつかの手段が考えられる。
    - 日本語での自由記述を前提にする場合
      - プロンプトの条件に、ソースコード、機能仕様書との関連付けに必要な用語の読替票や参照先の具体的なページ番号・行番号などのポインタを指定する
    - 生成AI向けにそもそも前提情報を調整する場合
      - チケットの記述ルールをあらかじめ生成AIに渡す前提にする
        - これは実質、プロンプトをチケットに記載する意思決定になる
  - 考察: 機能設計書が生成AIから参照できる形式ではない・不適切である（現実的に生成AIに質問として投げかけても期待する結果が出ないという意味での不適切であり）場合がある。
    - 生成AI登場以前に作られた仕様書の場合は前提とせざるを得ないことを理解しておく
    - 生成AI登場以降に作る仕様書の場合、どのような形式で記述すると適切だろうか。生成AIが処理可能なファイル形式、得意なファイル形式をあらかじめ理解しておくとよい。
  - 考察: ソースコードとの関連付けについて。リポジトリの場所やブランチを与えたとしても、ある程度大規模なアプリケーションの場合、生成AIから修正工数に関する適切な回答を得ることは期待できないと言えそう。
    - エンジニアから具体的なソースプログラムのファイルや該当箇所を指示するか、後述するGithub Copilotのよう生成AIの併用を考えるべき。
    - 例えばバリデーションの修正のような一般的な修正については、アプリケーション構成資料の作成・活用をすることで、生成AIからの応答を引き出せる可能性が高まるかもしれない。
      - ドキュメント上にアプリケーション構成を記述し、ソースファイルとの関連性がわかるようにしておく
    - このようなテーマで取り組んでいる他の人々がどのようなアプローチで仕様を記述したり、生成AIに質問を投げかけたりしているか調べておく

- 課題: ソースコードとの関連付けができた場合、これらを修正するための具体的なアプローチを決める必要がある
  - CursorやGithub Copilotのような開発中のコードベースを情報源とした生成AIの活用が前提になりそう

- 課題: 人間同士で修正工数の算出に関するやりとりでは、修正工数（ユニットテストまで）の算出依頼をきっかけに、経緯が複雑に絡み合ったやりとりが始まった。具体的には、仕様とバックエンドプログラム実装の整合性確認、仕様が変更されたタイミングの追跡調査、そして、横並び確認対象の絞り込み提案などのやりとりが人間同士で行われた。
  - このようなやり取りを生成AIで置き換える場合、どのようなアプローチがあるだろうか。或いは現実的に生成AIに置き換え可能だろうか。やるとしたらどのような方法でやるか、やる・やらないの一般的な判断基準、このケースでは現実的に可能かについての回答


## ChatGPTで壁打ち

- New chat https://chat.openai.com/share/3ce2c44f-4c3e-4fb6-9a8e-88746dfd37c7

1.5h: 2023年1月16日_生成AI活用_機密.pdfファイルを用意
0.15h: 質疑応答1
    Q.生成AIで置き換え可能か検討した結果に対するアドバイスをもらうためにChatGPTに壁打ち
        あなたはアプリケーション開発と生成AI活用のスペシャリストです。
        私が仕事でよく行う、アプリケーション修正工数の算出のやり取り（以下、アプリケーション修正工数の算出業務）
        に、昨今の生成AIの流行を取り入れることで、アプリケーション修正工数の算出業務を効率化したいと考えているので
        こちらがアプリケーション修正工数の算出業務の全てまたは一部を、生成AIで置き換え可能か検討した結果に対して
        一般的な生成AIの使い方や制約と照らし合わせてアドバイスをしてください。
        生成AIで置き換え可能か検討した結果は、添付ファイル内のプロンプト と 考察 欄にまとめましたのでそちらを参照ください。
        
        日本語で回答してください。
    A. 
        一般的な生成AIの使用方法と制約を考慮に入れることが重要です。生成AIはデータ駆動型のため、適切なデータとクリアなプロセス定義が必要です。また、AIの結果は常に検証が必要であり、すべてのケースに適用可能ではないことを理解することが重要
        生成AIを活用する際には、データの質とアクセス、自然言語の理解、ドキュメントのフォーマットなどに注意が必要です。また、AIの能力と限界を理解し、人間のレビューとのバランスを取ることが重要
0.15h: 追加質疑応答1
    Q. もう少し具体的なアドバイスをお願い
    A. アプリケーション修正工数の算出業務における生成AIの活用に関して、以下のような具体的なアドバイスを提供します。
          - データ収集と整理：過去のプロジェクトデータを収集し、AIが分析しやすい形式に整理します。これには、工数、タスクの種類、プロジェクトの規模、使用技術などの情報が含まれるべきです。
          - AIモデルのトレーニング：収集したデータを用いて、AIモデルをトレーニングします。この段階では、工数予測の精度を高めるために、継続的な調整とテストが必要になります。
          - ドキュメントのAI対応化：機能設計書などのドキュメントをAIが理解しやすい形式に変換します。これには、構造化されたフォーマットへの変換や、重要な情報の抽出・要約が含まれます。
          - ツールとの統合：AIモデルを既存の開発ツールやプラットフォームに統合します。これにより、チームメンバーがAIの予測結果を容易に参照し、活用できるようになります。
          - 継続的な監視と改善：AIのパフォーマンスを継続的に監視し、新しいデータやフィードバックに基づいてモデルを調整します。
        これらのステップを実施することで、アプリケーション修正工数の算出業務において、生成AIの効果的な活用が可能になると考えられます。ただし、AIの予測には限界があるため、最終的な決定は人間の専門知識に依存することが重要
0.15h: 追加質疑応答2
    Q. AIが分析しやすい形式 、AIが理解しやすい形式って具体的にはどんな形式が一般的に使われる？AIのパフォーマンスを継続的に監視する場合、一般的にはどんなインジケータを監視するもの？
0.15h: 追加質疑応答3
    Q. 例えばChatGPTを使っているとして、精度（Accuracy）や再現率（Recall）などの監視はどうすれば行える？自分で定義しなきゃダメ？
0.15h: 追加質疑応答4
    Q. 期待値（正解）を含むテストデータセットを用意して、実際にChatGPTから返却された回答との一致・不一致、或いは、類似度を評価すれば、精度や再現率が得られると理解しました。あっていますか？
0.15h: 追加質疑応答5
    Q. ChatGPTを使って、AIモデルのトレーニングをする場合、具体的にはどのようなシステムを構築すればトレーニングが効果的に行えるようになりますか。また、AWS上でそのようなシステムを作る場合のシステム構成図を挙げて説明できますか。
    A. ChatGPTのようなAIモデルのトレーニングを効果的に行うためのシステムをAWS上で構築する場合、以下のようなコンポーネントが含まれる可能性があります。これらのコンポーネントを組み合わせることで、AWS上で効果的なAIモデルトレーニングシステムを構築できます。ただし、具体的な構成はプロジェクトの要件や規模に応じて異なります
      - 計算リソース：EC2インスタンスやAmazon SageMakerなど、強力な計算能力を持つリソースを使用します。特に、GPUを搭載したインスタンスがモデルトレーニングに適しています。
      - データストレージ：トレーニングデータを保管するために、Amazon S3バケットやRDS（リレーショナルデータベースサービス）を利用します。
      - データ処理：Amazon EMR（Elastic MapReduce）やAWS Glueなどを使用して、大量のデータを前処理・整形します。
      - モデル管理：トレーニングされたモデルのバージョン管理やデプロイを行うために、AWS CodeCommitやAmazon SageMakerなどを使用します。
      - セキュリティとネットワーキング：VPC（Virtual Private Cloud）やIAM（Identity and Access Management）を用いて、ネットワークとアクセスのセキュリティを確保します。
      - モニタリングとログ管理：Amazon CloudWatchやAWS CloudTrailを使用して、システムのパフォーマンスを監視し、ログを管理します。
0.15h: 追加質疑応答6
    Q. システム構成図に落とし込む場合、あとどんな情報があればできますか？
    A. 具体的な要件と目的：システムが達成すべき具体的な目的や要件を明確にします。
      - 使用するAWSサービスの選定：必要なサービス（EC2, S3, SageMakerなど）を選定し、それぞれの役割を明確にします。
      - リソース間の関係：各サービス間のデータフローや通信の関係を理解します。
      - セキュリティとアクセス管理：セキュリティポリシー、IAMロール、ネットワーク設定などの詳細を考慮します。
      - スケーリングとパフォーマンス要件：システムのスケーラビリティとパフォーマンス要件を定義します。

## 参考: 生成AIに質問を投げる場合のプロンプトの基本形(1/15)

`参考図書: ChatGPT 120%質問術(ChatGPTビジネス研究会, 宝島社) 第一章 プロンプトの基本形を知っておく`

1. 役割: 回答の方向性を決めるため、AIにどんな役割を担わせるかを決める情報
2. 指示・質問: AIにさせたいことを記述する。省略すべきではない。なるべく具体的に記述する。プロンプト内でもなるべく前の方に記述することを推奨。
3. 目的: 指示・質問の目的を必要に応じて記述する、指示・質問への回答が、小学生向けの解説、専門家向けの解説など特別な場合省略せずに記述するとよい。
4. 条件: 守って欲しい条件を列挙する。明瞭でなければ無視される確率が高まるので、理解しやすい形で箇条書きなどで記述すると良い。
5. 回答サンプル: 必要に応じて記載。例を挙げると良い結果が得られやすくなる。
6. 処理対象のデータ: 必要に応じて記載。例えば、文章の要約や、表データの処理などの場合は、処理対象のデータもプロンプト内に記述する。
7. 出力形式: 必要に応じて記載。箇条書き、表形式など回答の出力形式に関する指定を記述する。

## 参考: 人間同士で修正工数の算出に関するやりとりをチャットで行った時のやりとり(1/15)

### やっていること


- 修正工数（ユニットテストまで）の算出依頼を受けて、以下の関連する
  - バックエンドAPI実装の確認
  - バックエンドAPI仕様と実装の整合性確認
  - バックエンドAPI修正工数計算
  - バックエンドAPI仕様が変更されたタイミングの追跡調査
  - 横並び確認対象の絞り込み提案

### 履歴

`時系列順に上から並べています`

- 発言者: クライアント

```
バックエンドの修正工数（ユニットテストまで）の算出をお願いします
https://secret-fqdn/browse/ASAP-5029
```

- 発言者: 作業者

```
バックエンド側の現状の実装を確認したところ、作業の請求受入可能日について作業予定日やタスク登録日関連のバリデーションはそもそも実装されておらず、修正なしで期待通りの動きになると思われます。

https://secret-fqdn/browse/ASAP-5029?focusedCommentId=13096

バックエンド側の作業料の請求受入可能日の入力チェック処理実装を確認しました。
対応内容に記載されている以下の２つの入力チェックは、バックエンド側ではそもそも行なっていないようです。
• 作業受け入れ可能日が工事着手予定日より後である
• タスク登録日以降等の他のバリデーションチェック
そのため、チケットに記載された対応内容通りであれば、BE作業は不要（0人日）という認識です。
FYI: バックエンド側の作業料の請求受入可能日(acceptable_for_requested_at )の入力チェック処理実装箇所
• https://secret-aws-fqdn/codesuite/codecommit/repositories/backend/browse/refs/heads/develop/--/domain/business/designprj/contract.go?region=ap-northeast-1&lines=152-152
• https://secret-aws-fqdn/codesuite/codecommit/repositories/backend/browse/refs/heads/develop/--/domain/business/designprj/contract.go?region=ap-northeast-1&lines=201-201
```

- 発言者: クライアント

```
ありがとうございます。他にも日付のバリデーションチェックが入っていない箇所がありそうですね。。。
```

- 発言者: 作業者

```
バックエンド側は
機能設計書の「作業更新」シートの処理仕様に沿って実装されているようなので
コメントにその旨と、機能設計書の該当箇所を追記しておきました
https://secret-fqdn/browse/ASAP-5029?focusedCommentId=13096 
```

- 発言者: クライアント

```
ありがとうございます。他の機能設計書を確認しましたが、リングイン報告は日付チェックのバリデーションがなさそうなので、修正が必要そうですね。
明日、下記の「画面チェック仕様」シートの13行目、14行目に相当するバリデーションチェックがバックエンド側で行われていないかご確認いただけませんでしょうか？
https://secret-box-fqdn/file/1366046754759
```

- 発言者: 作業者

```
リングイン報告の、着工予定日、竣工予定日に対する画面チェック仕様は、当初から機能設計書に記載がされており、かつ、BE側も対応するバリデーションがされていました
https://secret-box-fqdn/file/1366046754759
実装の該当箇所
https://secret-aws-fqdn/codesuite/codecommit/repositories/backend/browse/[…]nprj/specin.go?region=ap-northeast-1&lines=120-120 
```

- 発言者: 作業者

```
作業報告→リングインの横展開についてですが
可能であれば、まず作業報告のバリデーションについて
どこのタイミングでFEとBEに差異が生じたのか 混入原因を突き止めてから
対応相談が良いと思いました。
※赤字の箇所（或いは、実装が終わってから仕様の修正が入った箇所）をトレースするのであれば、横展開の対象は、リングイン以外の他の何かになると思いました。

- 2023年11月時点 3_機能設計書_作業報告.xlsx https://secret-box-fqdn/file/1366044112450
- 2023年10月18日 3_機能設計書_作業報告(Google Drive) https://docs.google.com/spreadsheets/d/1gdai-adw5KKqaGXDBn9QAAk-Ujr35gl-/edit#gid=1646548284
  - 履歴で確認すると赤字の仕様追記されたのは 10月18日（編集者：田中さん）でした
- 2023年9月7日 ASAP-3186 作業更新API実装 PullRequest作成された PR: https://secret-aws-fqdn/codesuite/codecommit/repositories/backend/pull-requests/386
  - BE側の実装・レビュー時は、少なくとも「機能設計書の処理仕様に記載されている」或いは「画面チェック仕様に記載されている」仕様についてはバリデーション実装が行われてるか確認しながら進めていた記憶です
- 2023年5月時点 3_機能設計書_作業報告.xlsx  https://secret-box-fqdn/file/1198446603212
```
